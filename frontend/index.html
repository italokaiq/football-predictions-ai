<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>âš½ PrevisÃµes de Futebol IA</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
</head>
<body class="bg-gray-50">
    <!-- Header -->
    <header class="bg-white shadow-sm border-b">
        <div class="max-w-7xl mx-auto px-4 py-6">
            <h1 class="text-3xl font-bold text-gray-900">âš½ PrevisÃµes de Futebol IA</h1>
            <p class="text-gray-600 mt-2">AnÃ¡lise inteligente com Machine Learning e Redes Neurais</p>
        </div>
    </header>

    <div class="max-w-7xl mx-auto px-4 py-8">
        <!-- Tabs -->
        <div class="mb-8">
            <div class="border-b border-gray-200">
                <nav class="-mb-px flex space-x-8">
                    <button onclick="showTab('neural')" id="tab-neural" class="py-2 px-1 border-b-2 border-blue-500 text-blue-600 font-medium text-sm">
                        ðŸ§  PrevisÃµes IA (Ensemble)
                    </button>
                    <button onclick="showTab('stats')" id="tab-stats" class="py-2 px-1 border-b-2 border-transparent text-gray-500 hover:text-gray-700 font-medium text-sm">
                        ðŸ“Š AnÃ¡lise EstatÃ­stica
                    </button>
                    <button onclick="showTab('combo')" id="tab-combo" class="py-2 px-1 border-b-2 border-transparent text-gray-500 hover:text-gray-700 font-medium text-sm">
                        ðŸŽ¯ Melhor CombinaÃ§Ã£o
                    </button>
                </nav>
            </div>
        </div>

        <!-- Loading -->
        <div id="loading" class="text-center py-12">
            <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"></div>
            <p class="mt-4 text-gray-600">Carregando previsÃµes...</p>
        </div>

        <!-- Neural Predictions -->
        <div id="neural-content" class="hidden">
            <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6">
                <h3 class="font-semibold text-blue-900 mb-2">ðŸ§  Ensemble de Modelos IA</h3>
                <p class="text-blue-700 text-sm">Combina AnÃ¡lise EstatÃ­stica + Rede Neural + Random Forest para mÃ¡xima precisÃ£o</p>
            </div>
            <div id="neural-predictions" class="grid gap-6 md:grid-cols-2"></div>
        </div>

        <!-- Statistical Predictions -->
        <div id="stats-content" class="hidden">
            <div id="stats-predictions" class="grid gap-6 md:grid-cols-2"></div>
        </div>

        <!-- Best Combo -->
        <div id="combo-content" class="hidden">
            <div class="bg-white rounded-lg shadow-md p-6">
                <h3 class="text-xl font-semibold text-gray-900 mb-4">ðŸŽ¯ Melhor CombinaÃ§Ã£o do Dia</h3>
                <div id="combo-data"></div>
            </div>
        </div>
    </div>

    <script>
        let currentTab = 'neural';
        let data = {};

        // Fetch data from API
        async function fetchData() {
            try {
                const API_BASE = window.location.hostname === 'localhost' ? 
                    'http://localhost:5000' : 
                    'https://api-de-futebol-atic597ww-italo-kaiqs-projects.vercel.app';
                    
                const [predRes, neuralRes, comboRes] = await Promise.all([
                    axios.get(`${API_BASE}/predictions`),
                    axios.get(`${API_BASE}/predictions/neural`),
                    axios.get(`${API_BASE}/best-combo`)
                ]);
                
                data.predictions = predRes.data.predictions || [];
                data.neuralPredictions = neuralRes.data.predictions || [];
                data.bestCombo = comboRes.data;
                
                renderData();
                document.getElementById('loading').classList.add('hidden');
                showTab(currentTab);
            } catch (error) {
                console.error('Erro ao buscar dados:', error);
                document.getElementById('loading').innerHTML = '<p class="text-red-600">Erro ao carregar dados. Verifique se o backend estÃ¡ rodando.</p>';
            }
        }

        function getConfidenceColor(confidence) {
            switch(confidence) {
                case 'Muito Alta': return 'text-green-600 bg-green-100';
                case 'Alta': return 'text-green-600 bg-green-100';
                case 'MÃ©dia': return 'text-yellow-600 bg-yellow-100';
                case 'Baixa': return 'text-red-600 bg-red-100';
                default: return 'text-gray-600 bg-gray-100';
            }
        }

        function renderNeuralPredictions() {
            const container = document.getElementById('neural-predictions');
            container.innerHTML = '';
            
            data.neuralPredictions.forEach(pred => {
                const card = document.createElement('div');
                card.className = 'bg-white rounded-lg shadow-md p-6';
                card.innerHTML = `
                    <div class="flex justify-between items-start mb-4">
                        <h3 class="text-lg font-semibold text-gray-900">${pred.match}</h3>
                        <span class="px-2 py-1 rounded-full text-xs font-medium ${getConfidenceColor(pred.confidence)}">
                            ${pred.confidence}
                        </span>
                    </div>
                    
                    <div class="space-y-3">
                        <div class="bg-gray-50 rounded p-3">
                            <p class="font-medium text-gray-900 mb-2">ðŸŽ¯ Melhor Aposta:</p>
                            <p class="text-blue-600 font-semibold">${pred.best_bet[0]}</p>
                            <p class="text-sm text-gray-600">Probabilidade: ${(pred.best_bet[1] * 100).toFixed(1)}%</p>
                        </div>
                        
                        <div class="grid grid-cols-2 gap-4 text-sm">
                            <div>
                                <p class="text-gray-600">Casa: ${(pred.prediction.home_win_prob * 100).toFixed(1)}%</p>
                                <p class="text-gray-600">Empate: ${(pred.prediction.draw_prob * 100).toFixed(1)}%</p>
                                <p class="text-gray-600">Fora: ${(pred.prediction.away_win_prob * 100).toFixed(1)}%</p>
                            </div>
                            <div>
                                <p class="text-gray-600">Over 2.5: ${(pred.prediction.over_2_5_prob * 100).toFixed(1)}%</p>
                                <p class="text-gray-600">Modelos: ${pred.models_used.length}</p>
                            </div>
                        </div>
                    </div>
                `;
                container.appendChild(card);
            });
        }

        function renderStatsPredictions() {
            const container = document.getElementById('stats-predictions');
            container.innerHTML = '';
            
            data.predictions.forEach(pred => {
                const card = document.createElement('div');
                card.className = 'bg-white rounded-lg shadow-md p-6';
                card.innerHTML = `
                    <div class="flex justify-between items-start mb-4">
                        <h3 class="text-lg font-semibold text-gray-900">${pred.game}</h3>
                        <span class="px-2 py-1 rounded-full text-xs font-medium ${getConfidenceColor(pred.confidence)}">
                            ${pred.confidence}
                        </span>
                    </div>
                    
                    <div class="space-y-3">
                        <div class="bg-gray-50 rounded p-3">
                            <p class="font-medium text-gray-900 mb-1">ðŸ“ˆ PrevisÃ£o:</p>
                            <p class="text-blue-600 font-semibold">${pred.prediction}</p>
                            <p class="text-sm text-gray-600">Probabilidade: ${(pred.probability * 100).toFixed(1)}%</p>
                        </div>
                        
                        ${pred.expected_goals ? `<p class="text-sm text-gray-600">Gols esperados: ${pred.expected_goals}</p>` : ''}
                    </div>
                `;
                container.appendChild(card);
            });
        }

        function renderBestCombo() {
            const container = document.getElementById('combo-data');
            const combo = data.bestCombo;
            
            if (combo.games && combo.games.length > 0) {
                container.innerHTML = `
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                        <div class="bg-green-50 rounded p-4 text-center">
                            <p class="text-green-600 font-semibold text-lg">${combo.total_odds}</p>
                            <p class="text-green-700 text-sm">Odds Total</p>
                        </div>
                        <div class="bg-blue-50 rounded p-4 text-center">
                            <p class="text-blue-600 font-semibold text-lg">${combo.expected_return}</p>
                            <p class="text-blue-700 text-sm">Retorno Esperado</p>
                        </div>
                        <div class="bg-purple-50 rounded p-4 text-center">
                            <p class="text-purple-600 font-semibold text-lg">${combo.confidence}</p>
                            <p class="text-purple-700 text-sm">ConfianÃ§a</p>
                        </div>
                    </div>
                    
                    <div class="space-y-3">
                        ${combo.games.map(game => `
                            <div class="border rounded p-4">
                                <div class="flex justify-between items-center">
                                    <div>
                                        <p class="font-medium">${game.match}</p>
                                        <p class="text-blue-600">${game.bet}</p>
                                    </div>
                                    <div class="text-right">
                                        <p class="font-semibold">${game.odds}</p>
                                        <p class="text-sm text-gray-600">${(game.probability * 100).toFixed(1)}%</p>
                                    </div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                `;
            } else {
                container.innerHTML = '<p class="text-gray-600">Nenhuma combinaÃ§Ã£o segura encontrada hoje.</p>';
            }
        }

        function renderData() {
            renderNeuralPredictions();
            renderStatsPredictions();
            renderBestCombo();
        }

        function showTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('[id$="-content"]').forEach(el => el.classList.add('hidden'));
            document.querySelectorAll('[id^="tab-"]').forEach(el => {
                el.className = 'py-2 px-1 border-b-2 border-transparent text-gray-500 hover:text-gray-700 font-medium text-sm';
            });
            
            // Show selected tab
            document.getElementById(tabName + '-content').classList.remove('hidden');
            document.getElementById('tab-' + tabName).className = 'py-2 px-1 border-b-2 border-blue-500 text-blue-600 font-medium text-sm';
            
            currentTab = tabName;
        }

        // Initialize
        fetchData();
    </script>
</body>
</html>